pkgbase=msmtp
pkgname=('msmtp' 'msmtp-mta')
pkgver=1.4.30
pkgrel=1
arch=('i686' 'x86_64')
license=('GPL3')
url="http://msmtp.sourceforge.net"
makedepends=('gsasl')
source=(http://download.sourceforge.net/sourceforge/msmtp/${pkgbase}-${pkgver}.tar.bz2)
sha1sums=('fd469bae0c3394b30b771780e62bbd41c4d5d175')

build() {
  cd "${srcdir}/${pkgbase}-${pkgver}"
  ./configure --prefix=/usr --sysconfdir=/etc \
      --disable-nls --disable-largefile \
      --with-ssl=gnutls --without-gnome-keyring
  make
}

package_msmtp() {
  pkgdesc="A mini smtp client"
  depends=('gsasl')
  install=msmtp.install

  cd "${srcdir}/${pkgbase}-${pkgver}"
  make DESTDIR="${pkgdir}" install 

  install -D -m644 scripts/vim/msmtp.vim "${pkgdir}/usr/share/vim/vimfiles/syntax/msmtp.vim"
}

package_msmtp-mta() {
  pkgdesc="A mini smtp client - the regular MTA"
  depends=('msmtp')
  provides=('smtp-forwarder')

  install -d "${pkgdir}/usr/sbin"
  ln -s /usr/bin/msmtp "${pkgdir}/usr/sbin/sendmail"
}
